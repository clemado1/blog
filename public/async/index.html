<!DOCTYPE html>
<html lang="en">
    <head>
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge" >
        <meta http-equiv="content-type" content="text/html; charset=utf-8">

        <!-- SEO -->
        
        <title> [스터디] 비동기 |  </title>
        

        <!-- Enable responsiveness on mobile devices-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" >

        <!-- js -->
        <script src="gallant-goldwasser-cea001.netlify.app/theme_selector.js"></script>
        <script src="https://kit.fontawesome.com/e307e34624.js" crossorigin="anonymous"></script>

        <!--  css -->
        <link id="themeCSS" rel="stylesheet"
                            href="gallant-goldwasser-cea001.netlify.app/default.css"
                            />

        <!-- fonts -->
        <!-- preload  -->
        <link rel="preload" href="https://fonts.googleapis.com/css?family=Montserrat:200,300,300i,400,500,500i,600,700,800,900|Raleway" as="style">
        <!-- load -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:200,300,300i,400,500,500i,600,700,800,900|Raleway">
        
    </head>

    <body onload="main();">
      
<input type="checkbox" id="openSidebarMenu" class="openSidebarMenu">
<label class="menu cross menu--1" for="openSidebarMenu">
    <svg viewBox="0 0 75 75" xmlns="https://www.w3.org/2000/svg">
        <circle cx="50" cy="50" r="30" />
        <path class="line--1" d="M0 40h62c13 0 6 28-4 18L35 35" />
        <path class="line--2" d="M0 50h70" />
        <path class="line--3" d="M0 60h62c13 0 6-28-4-18L35 65" />
    </svg>
</label>

<div id="sidebarMenu">
    <div class="menu_wrapper">
        <ul class="sidebarMenuInner">
            <li>
                <a href="gallant-goldwasser-cea001.netlify.app" ></a>
                <div class="menu_div" ></div>
            </li>
            
            



<li >
    <a href="https:&#x2F;&#x2F;github.com&#x2F;clemado1" target="_blank">clemado1</a>
    <i class="fab fa-github"></i>
</li>



<li >
    <a href="https:&#x2F;&#x2F;twitter.com&#x2F;clemado1" target="_blank">@clemado1</a>
    <i class="fab fa-twitter"></i>
</li>



<li >
    <a href="mailto:clemado1@gmail.com" target="_blank">contact</a>
    <i class="fas fa-envelope"></i>
</li>



<li >
    <a href="https:&#x2F;&#x2F;instagram.com&#x2F;clemdis" target="_blank">clemdis</a>
    <i class="fab fa-instagram"></i>
</li>





        </ul>
    </div>
</div>



      
<nav id="overlord" class="overlord" >
  
  
<figure class="mini_logo ">
    <a href="gallant-goldwasser-cea001.netlify.app" style="background-image: url(/img/profile.png)"></a>
</figure>
<h5>
    <a href="gallant-goldwasser-cea001.netlify.app"></a>
</h5>

  



</nav>

<section class="post_container">
  <article>
    
      <h1 class="article_title"><a href="gallant-goldwasser-cea001.netlify.app&#x2F;async&#x2F;" id="article_link">[스터디] 비동기</a></h1>
      
<ul class="frontmatter frontmatter_page" id="frontmatter">
    <li>
        <time class="article_time" datetime="2021-01-18">January 18, 2021</time>
    </li>
    <span class="dotDivider"></span>
    <li> 444 words </li>
    <span class="dotDivider" ></span>
    <li> 3 min </li>
</ul>

      <p>입출력(I/0) 시스템을 구현한다면 소켓에서 데이터를 읽어오는 작업이 있을 것이다. 만약 단순히 동기 방식으로 데이터를 읽어온다면 소켓에서 데이터를 읽을 수 있을 때 까지 자원을 유휴 상태로 만들면서 기다릴 것이다. 만약 여러 소켓으로부터 한 번에 데이터를 읽으려면 소켓 수 만큼이나 스레드가 필요하고 이는 결국 치명적인 문제를 유발한다. <a href="http://www.kegel.com/c10k.html">The C10K Problem</a> 이를 해결하기 위한 방법으로 NonBlocking과 비동기 호출이 있다. NonBlocking과 비동기는 개념의 유사성때문에 주로 같이 사용하기도 하지만 나누어보면 아래와 같다.</p>
<br/>
<table><thead><tr><th>구분</th><th>개념</th></tr></thead><tbody>
<tr><td><strong>비동기</strong></td><td>입출력이나 연산, 조회 등 작업을 시작한 다음 기다리지 않고 있다가 약속한 시점에 데이터를 받거나 행위를 수행하는 방식</td></tr>
<tr><td><strong>NonBlocking</strong></td><td>입출력이나 연산, 조회 등 작업을 시작한 다음 스레드를 Block하지 않고 다른 작업을 수행하는 방식</td></tr>
</tbody></table>
<br/>
<br/>
<h1 id="biddongi-asynchrony">비동기 (Asynchrony)</h1>
<p>비동기 프로그래밍은 코드의 흐름과 상관없이 이벤트를 처리한다. 냄비에 올려두고 잠깐 설거지를 하듯이 작업을 실행하고 다른 일을 하거나 쉬고 있다가 특정 시간에 확인할 수 있다. 보통은 <code>javascript</code>가 그러하듯이 <code>completion</code> 방식으로, 작업이 완료되면 미리 보낸 <code>callback</code> 함수를 호출한다. 드물게 <code>Rust</code>는 <code>pull</code> 방식을 사용하는데 따로 <code>callback</code> 함수를 두지 않고 필요한 시점에 자료를 요청하는 방식이다. <code>pull</code> 방식은 비동기 프로그램도 동기 프로그램과 비슷하게 코딩할 수 있다는 장점이 있다.</p>
<h3 id="javascript">javascript</h3>
<p><code>javascript</code>의 내장 비동기 함수인 <code>setTimeout(callback, time)</code>를 사용한다. <code>setTimeout</code>은 <code>callback</code>함수와 대기할 시간(ms)을 인자로 받는다.</p>
<h4 id="callback">callback</h4>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">sayHello</span><span>(</span><span style="color:#bf616a;">name</span><span>, </span><span style="color:#bf616a;">func</span><span>) {
</span><span>	</span><span style="color:#96b5b4;">setTimeout</span><span>(() </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>		</span><span style="color:#8fa1b3;">func</span><span>(`</span><span style="color:#a3be8c;">Hello ${</span><span style="color:#bf616a;">name</span><span style="color:#a3be8c;">}!</span><span>`);
</span><span>	}, </span><span style="color:#d08770;">3000</span><span>);
</span><span>}
</span><span>
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">calling..</span><span>&quot;);
</span><span style="color:#8fa1b3;">sayHello</span><span>(&quot;</span><span style="color:#a3be8c;">Do</span><span>&quot;, </span><span style="color:#bf616a;">hi </span><span style="color:#b48ead;">=&gt; </span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(</span><span style="color:#bf616a;">hi</span><span>));
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">waiting..</span><span>&quot;);
</span></code></pre>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>calling..
</span><span>waiting..
</span><span>Hello Do!
</span></code></pre>
<p><code>javascript</code>의 전통적인 <code>callback</code>방식이다. <code>callback</code> 함수를 받아 실행하는 구조로 되어 있기 때문에 복잡한 프로그램에서는 아래와 같은 <a href="http://callbackhell.com/">Callback Hell</a>를 만날 수도 있다.</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#bf616a;">fs</span><span>.</span><span style="color:#8fa1b3;">readdir</span><span>(</span><span style="color:#bf616a;">source</span><span>, </span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">err</span><span>, </span><span style="color:#bf616a;">files</span><span>) {
</span><span>	</span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">err</span><span>) {
</span><span>		</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">Error finding files: </span><span>&quot; + </span><span style="color:#bf616a;">err</span><span>);
</span><span>	} </span><span style="color:#b48ead;">else </span><span>{
</span><span>		</span><span style="color:#bf616a;">files</span><span>.</span><span style="color:#96b5b4;">forEach</span><span>(</span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">filename</span><span>, </span><span style="color:#bf616a;">fileIndex</span><span>) {
</span><span>			</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(</span><span style="color:#bf616a;">filename</span><span>);
</span><span>			</span><span style="color:#8fa1b3;">gm</span><span>(</span><span style="color:#bf616a;">source </span><span>+ </span><span style="color:#bf616a;">filename</span><span>).</span><span style="color:#8fa1b3;">size</span><span>(</span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">err</span><span>, </span><span style="color:#bf616a;">values</span><span>) {
</span><span>				</span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">err</span><span>) {
</span><span>					</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">Error identifying file size: </span><span>&quot; + </span><span style="color:#bf616a;">err</span><span>);
</span><span>				} </span><span style="color:#b48ead;">else </span><span>{
</span><span>					</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(</span><span style="color:#bf616a;">filename </span><span>+ &quot;</span><span style="color:#a3be8c;"> : </span><span>&quot; + </span><span style="color:#bf616a;">values</span><span>);
</span><span>					</span><span style="color:#bf616a;">aspect </span><span>= </span><span style="color:#bf616a;">values</span><span>.width / </span><span style="color:#bf616a;">values</span><span>.height;
</span><span>					</span><span style="color:#bf616a;">widths</span><span>.</span><span style="color:#96b5b4;">forEach</span><span>(
</span><span>						</span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">width</span><span>, </span><span style="color:#bf616a;">widthIndex</span><span>) {
</span><span>							</span><span style="color:#bf616a;">height </span><span>= Math.</span><span style="color:#96b5b4;">round</span><span>(</span><span style="color:#bf616a;">width </span><span>/ </span><span style="color:#bf616a;">aspect</span><span>);
</span><span>							</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(
</span><span>								&quot;</span><span style="color:#a3be8c;">resizing </span><span>&quot; +
</span><span>									</span><span style="color:#bf616a;">filename </span><span>+
</span><span>									&quot;</span><span style="color:#a3be8c;">to </span><span>&quot; +
</span><span>									</span><span style="color:#bf616a;">height </span><span>+
</span><span>									&quot;</span><span style="color:#a3be8c;">x</span><span>&quot; +
</span><span>									</span><span style="color:#bf616a;">height</span><span>,
</span><span>							);
</span><span>							</span><span style="color:#bf616a;">this</span><span>.</span><span style="color:#96b5b4;">resize</span><span>(</span><span style="color:#bf616a;">width</span><span>, </span><span style="color:#bf616a;">height</span><span>).</span><span style="color:#96b5b4;">write</span><span>(
</span><span>								</span><span style="color:#bf616a;">dest </span><span>+ &quot;</span><span style="color:#a3be8c;">w</span><span>&quot; + </span><span style="color:#bf616a;">width </span><span>+ &quot;</span><span style="color:#a3be8c;">_</span><span>&quot; + </span><span style="color:#bf616a;">filename</span><span>,
</span><span>								</span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">err</span><span>) {
</span><span>									</span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">err</span><span>)
</span><span>										</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(
</span><span>											&quot;</span><span style="color:#a3be8c;">Error writing file: </span><span>&quot; + </span><span style="color:#bf616a;">err</span><span>,
</span><span>										);
</span><span>								},
</span><span>							);
</span><span>						}.</span><span style="color:#8fa1b3;">bind</span><span>(</span><span style="color:#bf616a;">this</span><span>),
</span><span>					);
</span><span>				}
</span><span>			});
</span><span>		});
</span><span>	}
</span><span>});
</span></code></pre>
<h4 id="promise">Promise</h4>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">sayHello</span><span>(</span><span style="color:#bf616a;">name</span><span>) {
</span><span>	</span><span style="color:#b48ead;">return </span><span>new Promise(</span><span style="color:#bf616a;">resolve </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>		</span><span style="color:#96b5b4;">setTimeout</span><span>(() </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>			</span><span style="color:#8fa1b3;">resolve</span><span>(`</span><span style="color:#a3be8c;">Hello ${</span><span style="color:#bf616a;">name</span><span style="color:#a3be8c;">}!</span><span>`);
</span><span>		}, </span><span style="color:#d08770;">3000</span><span>);
</span><span>	});
</span><span>}
</span><span>
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">calling..</span><span>&quot;);
</span><span style="color:#8fa1b3;">sayHello</span><span>(&quot;</span><span style="color:#a3be8c;">Do</span><span>&quot;).</span><span style="color:#96b5b4;">then</span><span>(</span><span style="color:#bf616a;">hi </span><span style="color:#b48ead;">=&gt; </span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(</span><span style="color:#bf616a;">hi</span><span>));
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">waiting..</span><span>&quot;);
</span></code></pre>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>calling..
</span><span>waiting..
</span><span>Hello Do!
</span></code></pre>
<p>ES6에서 추가된 <code>Promise</code></p>
<h4 id="promise-await-async">Promise + await/async</h4>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">sayHello</span><span>(</span><span style="color:#bf616a;">name</span><span>) {
</span><span>	</span><span style="color:#b48ead;">return </span><span>new Promise(</span><span style="color:#bf616a;">resolve </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>		</span><span style="color:#96b5b4;">setTimeout</span><span>(() </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>			</span><span style="color:#8fa1b3;">resolve</span><span>(`</span><span style="color:#a3be8c;">Hello ${</span><span style="color:#bf616a;">name</span><span style="color:#a3be8c;">}!</span><span>`);
</span><span>		}, </span><span style="color:#d08770;">3000</span><span>);
</span><span>	});
</span><span>}
</span><span>
</span><span style="color:#b48ead;">async function </span><span style="color:#8fa1b3;">getHelloStr</span><span>(</span><span style="color:#bf616a;">name</span><span>) {
</span><span>	</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">calling..</span><span>&quot;);
</span><span>	</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">hello </span><span>= </span><span style="color:#b48ead;">await </span><span style="color:#8fa1b3;">sayHello</span><span>(</span><span style="color:#bf616a;">name</span><span>);
</span><span>	</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(</span><span style="color:#bf616a;">hello</span><span>);
</span><span>	</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">waiting..</span><span>&quot;);
</span><span>}
</span><span>
</span><span style="color:#8fa1b3;">getHelloStr</span><span>(&quot;</span><span style="color:#a3be8c;">Do</span><span>&quot;);
</span></code></pre>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>calling..
</span><span>Hello Do!
</span><span>waiting..
</span></code></pre>
<p>ES7에서는 <code>Promise</code>와 함께 쓸 수 있는 <code>await</code>와 <code>async</code> 키워드가 추가되었다. <code>await</code>는 <code>Promise</code>가 완료될 때까지 <code>async</code> 함수의 실행을 일시 중지한다. <code>async</code> 함수 내에서만 사용 가능하다.</p>
<h3 id="rust">Rust</h3>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span>async </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">say_hello</span><span>(</span><span style="color:#bf616a;">name</span><span>: &amp;</span><span style="color:#b48ead;">str</span><span>) {
</span><span>    println!(&quot;</span><span style="color:#a3be8c;">Hello </span><span style="color:#d08770;">{}</span><span style="color:#a3be8c;">!</span><span>&quot;, name);
</span><span>}
</span><span>
</span><span>#[</span><span style="color:#bf616a;">tokio</span><span>::</span><span style="color:#bf616a;">main</span><span>]
</span><span>async </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>    </span><span style="color:#b48ead;">let</span><span> hello = </span><span style="color:#96b5b4;">say_hello</span><span>(&quot;</span><span style="color:#a3be8c;">Do</span><span>&quot;);
</span><span>    println!(&quot;</span><span style="color:#a3be8c;">Hi</span><span>&quot;);
</span><span>    hello.await;
</span><span>}
</span></code></pre>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Hi
</span><span>Hello Do!
</span></code></pre>

      
  </article>
</section>


       

      <footer>
        
          
          
<figure class="mini_logo ">
    <a href="gallant-goldwasser-cea001.netlify.app" style="background-image: url(/img/profile.png)"></a>
</figure>
<h5>
    <a href="gallant-goldwasser-cea001.netlify.app"></a>
</h5>

          
<ul class="social_list foot_list">
    



<li class="button extra_small font_faint">
    <a href="https:&#x2F;&#x2F;github.com&#x2F;clemado1" target="_blank">clemado1</a>
    <i class="fab fa-github"></i>
</li>



<li class="button extra_small font_faint">
    <a href="https:&#x2F;&#x2F;twitter.com&#x2F;clemado1" target="_blank">@clemado1</a>
    <i class="fab fa-twitter"></i>
</li>



<li class="button extra_small font_faint">
    <a href="mailto:clemado1@gmail.com" target="_blank">contact</a>
    <i class="fas fa-envelope"></i>
</li>



<li class="button extra_small font_faint">
    <a href="https:&#x2F;&#x2F;instagram.com&#x2F;clemdis" target="_blank">clemdis</a>
    <i class="fab fa-instagram"></i>
</li>





</ul>

          
<select id="theme_selector" size=1>
    <option value="default" selected>default</option>
    
    <option value="my-awesome-theme">my-awesome-theme</option>
    
</select>

        
      </footer>
    </body>
</html>
